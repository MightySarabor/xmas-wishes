package com.example.camelservice.routes;

import org.apache.camel.builder.RouteBuilder;
import org.springframework.stereotype.Component;

@Component
public class PdfToKafkaRoute extends RouteBuilder {
    @Override
    public void configure() throws Exception {
        from("file:/pdf-input?noop=true") // Ordner fÃ¼r PDF-Uploads
            .routeId("pdfToKafkaRoute")
            .log("Reading file: ${header.CamelFileName}")
            .process(exchange -> {
                // Dummy JSON erstellen
                String json = "{\"key\": \"value\"}";
                exchange.getIn().setBody(json);
            })
            .to("kafka:initial-topic?brokers=kafka:9092")
            .log("JSON sent to Kafka: ${body}");
    }
}
